---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const allPosts = (await getCollection('blog')).sort(
  (a, b) => new Date(b.data.publishedAt).getTime() - new Date(a.data.publishedAt).getTime()
);

function formatDate(date: string) {
  return new Date(date).toLocaleString('en-us', {
    month: 'short',
    day: 'numeric',
    year: 'numeric',
  });
}
---

<BaseLayout title="Blog" description="My Blog">
  <section>
    <h1 class="mb-8 text-2xl font-medium" style="color: var(--text-primary)">My Blog</h1>
    <div>
      {allPosts.map((post) => (
        <a href={`/blog/${post.slug}`} class="flex flex-col space-y-1 mb-5 transition-opacity duration-200 hover:opacity-80">
          <div class="w-full flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-1 sm:space-y-0 sm:space-x-2">
            <h2 style="color: var(--text-primary)">{post.data.title}</h2>
            <p class="tabular-nums text-sm" style="color: var(--text-tertiary)">
              {formatDate(post.data.publishedAt)}
            </p>
          </div>
        </a>
      ))}
    </div>
  </section>
</BaseLayout>
